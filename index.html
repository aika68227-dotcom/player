
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <!-- TAMBAHAN PENTING: viewport-fit=cover agar layar tembus poni -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Fluid Player - Notch Support</title>
    
    <!-- Fluid Player CDN -->
    <script src="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.js"></script>

    <style>
        /* Reset Body agar benar-benar full screen */
        body, html { 
            margin: 0; 
            padding: 0; 
            width: 100%; 
            height: 100%; 
            background-color: #000; 
            overflow: hidden; 
            font-family: 'Segoe UI', sans-serif;
        }
        
        #video-container {
            width: 100vw; 
            height: 100vh; 
            position: relative;
            background: #000;
        }
        
        video { 
            width: 100%; 
            height: 100%; 
            /* Opsional: 'cover' jika ingin video di-zoom memenuhi layar (terpotong dikit), 
               'contain' jika ingin full video tampil semua (mungkin ada bar hitam) */
            object-fit: contain; 
        }

        /* --- TEMA SKY BLUE --- */
        :root { --primary-color: #87CEEB; }

        .fluid_video_wrapper .fluid_button svg { fill: var(--primary-color) !important; }
        .fluid_video_wrapper .fluid_controls_progress_played { background-color: var(--primary-color) !important; }
        .fluid_video_wrapper .fluid_initial_play_button_inner { background-color: var(--primary-color) !important; }
        
        /* Navbar Judul - Diatur agar tidak tertutup Poni */
        .top-bar {
            position: absolute; 
            top: 0; left: 0; width: 100%;
            
            /* PENTING: Padding tambahan agar teks tidak tertutup poni HP */
            padding-top: max(15px, env(safe-area-inset-top)); 
            padding-left: max(20px, env(safe-area-inset-left));
            padding-right: max(20px, env(safe-area-inset-right));
            padding-bottom: 15px;

            background: linear-gradient(to bottom, rgba(0,0,0,0.9) 0%, transparent 100%);
            color: var(--primary-color);
            font-weight: bold; 
            letter-spacing: 1px;
            font-size: 14px;
            z-index: 100; 
            pointer-events: none; /* Agar klik tembus ke video */
            display: flex; 
            align-items: center;
            transition: opacity 0.5s;
        }
    </style>
</head>
<body>

<div id="video-container">
    <div class="top-bar" id="title-display">LOADING...</div>
    <video id="my-video" playsinline> 
        <source id="vid-src" src="" type="video/mp4"/>
    </video>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const urlParams = new URLSearchParams(window.location.search);
        const encodedId = urlParams.get('id');

        if (encodedId) {
            try {
                const data = JSON.parse(atob(encodedId));
                
                // 1. Set Video & Judul
                document.getElementById('vid-src').src = data.v;
                document.getElementById('title-display').innerText = "WATCHING: " + (data.r || "VIDEO");

                // 2. Set Subtitle
                if(data.s) {
                    const videoEl = document.getElementById('my-video');
                    const track = document.createElement('track');
                    track.kind = 'subtitles';
                    track.label = 'Indonesia';
                    track.srclang = 'id';
                    track.src = data.s;
                    track.default = true;
                    videoEl.appendChild(track);
                }

                // 3. Konfigurasi Iklan (Optimasi Onclicka/Adsterra)
                let vastSettings = {};
                if (data.a) {
                    vastSettings = {
                        adList: [{
                            roll: 'preRoll',
                            vastTag: data.a,
                            timer: 5
                        }],
                        skipButtonCaption: 'Lewati Iklan ([seconds])',
                        skipButtonClick: true,
                        adText: 'Sponsor',
                        adCTAText: 'Buka',
                        
                        // SETTING AGAR IKLAN LANCAR
                        allowVPAID: true,
                        vastTimeout: 10000, // Tunggu 10 detik
                        maxAllowedVastTagRedirects: 8,
                        vastAdvanced: {
                            videoExtensions: ['mp4', 'webm', 'ogg', 'm3u8'],
                            noVastAfterCa: false
                        }
                    };
                }

                // 4. Init Fluid Player
                var player = fluidPlayer('my-video', {
                    layoutControls: {
                        primaryColor: "#87CEEB",
                        fillToContainer: true, // Wajib true agar full screen
                        posterImage: '', 
                        autoPlay: false, // False agar browser tidak blokir iklan
                        playButtonShowing: true,
                        playPauseAnimation: true,
                        allowTheatre: false,
                        keyboardControl: true,
                        layout: 'default',
                        controlBar: {
                            autoHide: true,
                            autoHideTimeout: 3,
                            animated: true
                        }
                    },
                    vastOptions: vastSettings
                });
                
                // Logika Judul (Hilang saat Play, Muncul saat Pause)
                player.on('play', function() {
                    document.getElementById('title-display').style.opacity = '0'; 
                });
                player.on('pause', function() {
                     document.getElementById('title-display').style.opacity = '1';
                });
                player.on('ended', function() {
                     document.getElementById('title-display').style.opacity = '1';
                });

            } catch (e) {
                console.error("Error:", e);
            }
        }
    });
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"1f1bc143981c4a78865eda7a5b23b9c8","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>
